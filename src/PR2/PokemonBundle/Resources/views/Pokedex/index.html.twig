{% extends "PR2PokemonBundle::layout.html.twig" %}

{% block content %}
    <script type="text/javascript">
        angular.module('Pokedex', [], function($httpProvider) {
            $httpProvider.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded; charset=UTF-8';

            $httpProvider.defaults.transformRequest = function(data){
                return $.param(data);
            }
        }).config(function($interpolateProvider){
            $interpolateProvider.startSymbol('{[').endSymbol(']}');
        }).controller('pokedexCtrl',  function($scope, $http) {
            $scope.pokemons = [];
            $scope.loading = false;

            $scope.fetchPokemonByPagination = function() {
                $scope.pokemons = [];
                $scope.loading = true;
                $http.post('{{ path('pr2pokemon_pokedex_getpokemons') }}', {
                        //searchTerm: $scope.searchTerm,
                        //limit: $scope.itemPerPage,
                        //offset: $scope.currentPage * $scope.itemPerPage
                }).success(function (data) {
                    $scope.loading = false;
                    $scope.pokemons = data.pokemons;
                    //$scope.total = data.total;
                });
            };
            $scope.fetchPokemonByPagination();
        });
        
        angular.element(document).ready(function() {
            angular.bootstrap(document.getElementById('pokedex-listing'), ["Pokedex"]);
        });

        $(document).ready(function(){
            $('.list-bloc a').tooltip();
        });
    </script>

    <div class="page-header"><h1>Pok√©dex</h1></div>

    <div class="row">
        <div class="col-md-12">
            <div class="panel panel-primary">
                <div class="panel-body">
                    <div id="pokedex-listing" ng-controller="pokedexCtrl" class="text-center">
                        <div ng-repeat="pokemon in pokemons" class="bloc list-bloc">
                            <a href="" data-toggle="tooltip" data-placement="bottom" title="{[ pokemon.nom ]}">
                                <img src="{{ asset('uploads/img') }}/{[ pokemon.image.id + '.' + pokemon.image.url ]}">
                            </a>
                        </div>
                        <div ng-show="loading" class="loading-holder">
                            <div class="loading"><i></i><i></i></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}